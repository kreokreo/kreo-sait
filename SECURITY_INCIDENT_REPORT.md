# Отчет об инциденте безопасности

## Дата обнаружения: 8 декабря 2025

### Обнаруженные угрозы:

#### 1. Майнер /tmp/docker-daemon
- **Файл**: `/tmp/docker-daemon` (9.5 MB, ELF 64-bit)
- **Процесс**: PID 1326441 (использовал 96-99% CPU)
- **Подключение**: 194.41.112.90:44999
- **Статус**: ✅ Остановлен и удален

#### 2. Подозрительный файл /tmp/poop
- **Файл**: `/tmp/poop` (50 KB, ELF 32-bit)
- **Статус**: ✅ Удален

#### 3. Вредоносные Cron задачи
- **nextjs-server**: Загружает `/bin/.nodex` с IP 176.65.148.246 каждый час
- **rondo**: Запускает `react.x86_64.persisted` при перезагрузке
- **syshelper**: Запускается каждый час
- **systemhelper**: Запускается при перезагрузке и каждый час
- **Статус**: ✅ Удалены

#### 4. Вредоносные скрипты
- `/bin/.nodex` - загружается с внешнего сервера
- `/etc/rondo/rondo` - автозапуск майнера
- `/usr/local/bin/systemhelper` - подозрительный helper
- **Статус**: ✅ Удалены

### Внешние IP адреса злоумышленников:
- **176.65.148.246** - сервер для загрузки вредоносных скриптов
- **194.41.112.90:44999** - сервер майнинга/команд

### Время компрометации:
Судя по логам cron, вредоносные задачи выполнялись с 7 декабря 00:00

### Принятые меры:
1. ✅ Остановлены вредоносные процессы
2. ✅ Удалены вредоносные файлы из /tmp
3. ✅ Удалены вредоносные cron задачи
4. ✅ Удалены вредоносные скрипты
5. ✅ Перезапущен cron демон
6. ✅ Проверены SSH ключи (безопасны)

### Дополнительные обнаруженные угрозы:
- **/health.sh** - подозрительный скрипт, удален
- **Docker daemon (PID 452664)** - родительский процесс майнера (возможно, компрометирован)
- **Файл /tmp/docker-daemon** - защищен атрибутом immutable (e), пересоздается автоматически

### Принятые меры (дополнительно):
1. ✅ Удален /health.sh
2. ✅ Удалены init скрипты (/etc/init.d/rondo, /etc/init.d/systemhelper)
3. ✅ Удалены симлинки автозапуска (/etc/rc*.d/*rondo*, /etc/rc*.d/*helper*)
4. ✅ Удален systemd сервис nextjs-server.service
5. ✅ Удален /etc/rc.local
6. ✅ Удалена директория /etc/rondo
7. ⚠️ Блокировка вредоносных IP через UFW (требует настройки)

### Рекомендации:
1. **КРИТИЧНО**: Перезагрузить сервер для полной очистки процессов
2. **КРИТИЧНО**: Проверить Docker daemon на компрометацию
3. **Срочно**: Проверить все файлы на сервере на наличие бэкдоров
4. **Срочно**: Установить fail2ban для защиты от брутфорса
5. **Срочно**: Настроить файрвол (ufw) для ограничения доступа и блокировки вредоносных IP
6. **Важно**: Регулярно проверять процессы с высоким CPU
7. **Важно**: Мониторить cron задачи
8. **Важно**: Проверить логи Nginx на подозрительные запросы
9. **Рекомендуется**: Установить антивирус (ClamAV) для сканирования
10. **Рекомендуется**: Настроить автоматические обновления безопасности

### Дополнительная проверка:
- Проверить все пользовательские аккаунты
- Проверить историю команд (bash_history)
- Проверить сетевые подключения
- Проверить логи системы на другие подозрительные активности

